<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Alarm Clock</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #1abc9c;
            --accent-dark: #16a085;
            --danger: #e74c3c;
            --danger-dark: #c0392b;
            --success: #2ecc71;
            --text: #ecf0f1;
            --text-light: #bdc3c7;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }

        body {
            background: linear-gradient(135deg, var(--primary), #1a1f29);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-size: 3rem;
            background: linear-gradient(to right, var(--accent), #3498db);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-shadow: var(--shadow);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto;
        }

        .app-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(44, 62, 80, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--accent);
        }

        .panel-header i {
            font-size: 1.8rem;
            margin-right: 15px;
            color: var(--accent);
        }

        .panel-header h2 {
            font-size: 1.8rem;
            font-weight: 600;
        }

        /* Clock Styles */
        .clock-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .time-display {
            font-size: 4.5rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            color: var(--accent);
            text-shadow: 0 0 10px rgba(26, 188, 156, 0.5);
            letter-spacing: 2px;
        }

        .date-display {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: var(--text-light);
        }

        .analog-clock {
            position: relative;
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: var(--secondary);
            border: 8px solid var(--accent);
            box-shadow: var(--shadow), inset 0 0 20px rgba(0, 0, 0, 0.5);
            margin: 20px auto;
        }

        .analog-clock::before {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            background: var(--danger);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom;
            border-radius: 10px;
        }

        .hour-hand {
            width: 6px;
            height: 60px;
            background: var(--text);
            transform: translateX(-50%);
        }

        .minute-hand {
            width: 4px;
            height: 90px;
            background: var(--text);
            transform: translateX(-50%);
        }

        .second-hand {
            width: 2px;
            height: 100px;
            background: var(--danger);
            transform: translateX(-50%);
        }

        /* Alarm Panel */
        .alarm-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-light);
        }

        .form-control {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(26, 188, 156, 0.3);
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--primary);
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-dark);
            transform: translateY(-2px);
        }

        .alarm-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .alarm-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--accent);
            transition: var(--transition);
        }

        .alarm-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .alarm-info {
            display: flex;
            flex-direction: column;
        }

        .alarm-time {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--accent);
        }

        .alarm-label {
            font-size: 1.1rem;
            color: var(--text-light);
        }

        .alarm-actions {
            display: flex;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--accent);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Stopwatch and Timer */
        .stopwatch-display, .timer-display {
            font-size: 3.5rem;
            font-family: 'Courier New', monospace;
            text-align: center;
            margin: 20px 0;
            color: var(--accent);
            letter-spacing: 2px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
        }

        .lap-list {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .lap-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
        }

        .lap-item:last-child {
            border-bottom: none;
        }

        /* Timer progress bar */
        .progress-container {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 100%;
            transition: width 1s linear;
        }

        /* World Clock */
        .world-clocks {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .clock-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: var(--transition);
        }

        .clock-card:hover {
            transform: translateY(-3px);
            background: rgba(0, 0, 0, 0.3);
        }

        .clock-city {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--accent);
        }

        .clock-time {
            font-size: 1.5rem;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .clock-date {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Settings */
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .setting-item {
            margin-bottom: 20px;
        }

        .setting-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .setting-title i {
            margin-right: 10px;
            color: var(--accent);
        }

        .range-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .range-value {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
        }

        /* Alarm Modal */
        .alarm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: alarmPulse 1s infinite;
        }

        @keyframes alarmPulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        .alarm-content {
            background: var(--danger);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 0 30px rgba(231, 76, 60, 0.5);
        }

        .alarm-content h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            color: white;
        }

        .alarm-content p {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: white;
        }

        .alarm-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .alarm-buttons button {
            padding: 12px 25px;
            font-size: 1.2rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        .snooze-btn {
            background: #3498db;
            color: white;
        }

        .snooze-btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
        }

        .dismiss-btn {
            background: #2ecc71;
            color: white;
        }

        .dismiss-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Active alarm */
        .alarm-active {
            animation: pulse 1s infinite;
            border-left-color: var(--danger);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .app-container {
                gap: 15px;
            }
            
            .panel {
                padding: 20px;
            }
            
            .time-display {
                font-size: 3.5rem;
            }
            
            .alarm-form {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ultimate Alarm Clock</h1>
            <p class="subtitle">Fixed and enhanced with working alarms, stopwatch, timer, and world clock</p>
        </header>
        
        <div class="app-container">
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-clock"></i>
                    <h2>Digital Clock</h2>
                </div>
                <div class="clock-container">
                    <div class="time-display" id="time">00:00:00</div>
                    <div class="date-display" id="date">Monday, January 1, 2023</div>
                    
                    <div class="analog-clock" id="analog-clock">
                        <div class="hand hour-hand" id="hour-hand"></div>
                        <div class="hand minute-hand" id="minute-hand"></div>
                        <div class="hand second-hand" id="second-hand"></div>
                    </div>
                    
                    <div class="next-alarm">
                        <h3>Next Alarm: <span id="next-alarm">No alarms set</span></h3>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-bell"></i>
                    <h2>Alarms</h2>
                </div>
                
                <div class="alarm-form">
                    <div class="form-group">
                        <label for="alarm-time">Alarm Time</label>
                        <input type="time" class="form-control" id="alarm-time" value="07:00">
                    </div>
                    
                    <div class="form-group">
                        <label for="alarm-label">Label</label>
                        <input type="text" class="form-control" id="alarm-label" placeholder="Wake up alarm">
                    </div>
                    
                    <div class="form-group">
                        <label for="alarm-tone">Tone</label>
                        <select class="form-control" id="alarm-tone">
                            <option value="classic">Classic Alarm</option>
                            <option value="beep">Beep Pattern</option>
                            <option value="chime">Chime</option>
                            <option value="melody">Melody</option>
                            <option value="siren">Siren</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Repeat</label>
                        <div class="repeat-options">
                            <label><input type="checkbox" class="repeat-day" value="mon"> Mon</label>
                            <label><input type="checkbox" class="repeat-day" value="tue"> Tue</label>
                            <label><input type="checkbox" class="repeat-day" value="wed"> Wed</label>
                            <label><input type="checkbox" class="repeat-day" value="thu"> Thu</label>
                            <label><input type="checkbox" class="repeat-day" value="fri"> Fri</label>
                            <label><input type="checkbox" class="repeat-day" value="sat"> Sat</label>
                            <label><input type="checkbox" class="repeat-day" value="sun"> Sun</label>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-primary" id="add-alarm">
                    <i class="fas fa-plus"></i> Add Alarm
                </button>
                
                <div class="alarm-list" id="alarm-list">
                    <!-- Alarms will be added here dynamically -->
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-stopwatch"></i>
                    <h2>Stopwatch</h2>
                </div>
                
                <div class="stopwatch-display" id="stopwatch">00:00:00.00</div>
                
                <div class="controls">
                    <button class="btn btn-primary" id="start-stopwatch">
                        <i class="fas fa-play"></i> Start
                    </button>
                    <button class="btn btn-primary" id="lap-stopwatch" disabled>
                        <i class="fas fa-flag"></i> Lap
                    </button>
                    <button class="btn btn-danger" id="reset-stopwatch">
                        <i class="fas fa-redo"></i> Reset
                      </button>
                </div>
                
                <div class="lap-list" id="lap-list">
                    <!-- Lap times will be added here -->
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-hourglass-half"></i>
                    <h2>Timer</h2>
                </div>
                
                <div class="timer-display" id="timer">60:00</div>
                
                <div class="timer-controls">
                    <div class="form-group">
                        <label>Set Timer (minutes)</label>
                        <input type="number" class="form-control" id="timer-minutes" min="1" max="240" value="60">
                    </div>
                    
                    <div class="controls">
                        <button class="btn btn-primary" id="start-timer">
                            <i class="fas fa-play"></i> Start
                        </button>
                        <button class="btn btn-primary" id="pause-timer" disabled>
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <button class="btn btn-danger" id="reset-timer">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-globe-americas"></i>
                    <h2>World Clock</h2>
                </div>
                
                <div class="world-clocks" id="world-clocks">
                    <!-- World clocks will be added here -->
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <i class="fas fa-cog"></i>
                    <h2>Settings</h2>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-title">
                            <i class="fas fa-volume-up"></i>
                            <span>Alarm Volume</span>
                        </div>
                        <div class="range-container">
                            <input type="range" min="0" max="100" value="80" class="slider" id="volume-slider">
                            <span class="range-value" id="volume-value">80%</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-title">
                            <i class="fas fa-bed"></i>
                            <span>Snooze Duration</span>
                        </div>
                        <div class="range-container">
                            <input type="range" min="1" max="30" value="5" class="slider" id="snooze-slider">
                            <span class="range-value" id="snooze-value">5 min</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-title">
                            <i class="fas fa-stopwatch"></i>
                            <span>Alarm Duration</span>
                        </div>
                        <div class="range-container">
                            <input type="range" min="10" max="120" value="30" class="slider" id="duration-slider">
                            <span class="range-value" id="duration-value">30 sec</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-title">
                            <i class="fas fa-palette"></i>
                            <span>Theme</span>
                        </div>
                        <select class="form-control" id="theme-select">
                            <option value="dark">Dark Theme</option>
                            <option value="light">Light Theme</option>
                            <option value="blue">Ocean Blue</option>
                            <option value="green">Forest Green</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn btn-primary" id="save-settings">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
        
        <footer>
            <p>Ultimate Alarm Clock &copy; 2023 | Fixed and Enhanced Version</p>
        </footer>
    </div>
    
    <!-- Alarm Modal -->
    <div class="alarm-modal" id="alarm-modal">
        <div class="alarm-content">
            <h2>ALARM!</h2>
            <p id="alarm-message">Wake Up!</p>
            <div class="alarm-buttons">
                <button class="snooze-btn" id="snooze-alarm-btn">
                    <i class="fas fa-bed"></i> Snooze
                </button>
                <button class="dismiss-btn" id="dismiss-alarm-btn">
                    <i class="fas fa-check"></i> Dismiss
                </button>
            </div>
        </div>
    </div>
    
    <audio id="alarm-sound" loop>
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-classic-alarm-995.mp3" type="audio/mp3">
    </audio>
    
    <script>
        // Global variables
        let alarms = [];
        let stopwatchRunning = false;
        let stopwatchStartTime = 0;
        let stopwatchElapsed = 0;
        let stopwatchInterval;
        let lapTimes = [];
        let timerRunning = false;
        let timerDuration = 60 * 60; // 60 minutes in seconds
        let timerRemaining = timerDuration;
        let timerInterval;
        let alarmActive = false;
        let currentAlarm = null;
        let alarmTimeout;
        
        // DOM elements
        const timeDisplay = document.getElementById('time');
        const dateDisplay = document.getElementById('date');
        const analogClock = document.getElementById('analog-clock');
        const hourHand = document.getElementById('hour-hand');
        const minuteHand = document.getElementById('minute-hand');
        const secondHand = document.getElementById('second-hand');
        const nextAlarmDisplay = document.getElementById('next-alarm');
        const alarmTimeInput = document.getElementById('alarm-time');
        const alarmLabelInput = document.getElementById('alarm-label');
        const alarmToneSelect = document.getElementById('alarm-tone');
        const addAlarmBtn = document.getElementById('add-alarm');
        const alarmList = document.getElementById('alarm-list');
        const stopwatchDisplay = document.getElementById('stopwatch');
        const startStopwatchBtn = document.getElementById('start-stopwatch');
        const lapStopwatchBtn = document.getElementById('lap-stopwatch');
        const resetStopwatchBtn = document.getElementById('reset-stopwatch');
        const lapList = document.getElementById('lap-list');
        const timerDisplay = document.getElementById('timer');
        const timerMinutesInput = document.getElementById('timer-minutes');
        const startTimerBtn = document.getElementById('start-timer');
        const pauseTimerBtn = document.getElementById('pause-timer');
        const resetTimerBtn = document.getElementById('reset-timer');
        const progressFill = document.getElementById('progress-fill');
        const worldClocks = document.getElementById('world-clocks');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeValue = document.getElementById('volume-value');
        const snoozeSlider = document.getElementById('snooze-slider');
        const snoozeValue = document.getElementById('snooze-value');
        const durationSlider = document.getElementById('duration-slider');
        const durationValue = document.getElementById('duration-value');
        const themeSelect = document.getElementById('theme-select');
        const saveSettingsBtn = document.getElementById('save-settings');
        const alarmSound = document.getElementById('alarm-sound');
        const alarmModal = document.getElementById('alarm-modal');
        const alarmMessage = document.getElementById('alarm-message');
        const snoozeAlarmBtn = document.getElementById('snooze-alarm-btn');
        const dismissAlarmBtn = document.getElementById('dismiss-alarm-btn');
        
        // Initialize the application
        function init() {
            updateClock();
            setInterval(updateClock, 1000);
            setInterval(checkAlarms, 1000);
            updateWorldClocks();
            setInterval(updateWorldClocks, 1000);
            loadSettings();
            createSampleAlarms();
            createWorldClocks();
            
            // Event listeners
            addAlarmBtn.addEventListener('click', addAlarm);
            startStopwatchBtn.addEventListener('click', toggleStopwatch);
            lapStopwatchBtn.addEventListener('click', recordLap);
            resetStopwatchBtn.addEventListener('click', resetStopwatch);
            startTimerBtn.addEventListener('click', startTimer);
            pauseTimerBtn.addEventListener('click', pauseTimer);
            resetTimerBtn.addEventListener('click', resetTimer);
            saveSettingsBtn.addEventListener('click', saveSettings);
            snoozeAlarmBtn.addEventListener('click', snoozeAlarm);
            dismissAlarmBtn.addEventListener('click', dismissAlarm);
            
            volumeSlider.addEventListener('input', () => {
                volumeValue.textContent = `${volumeSlider.value}%`;
                alarmSound.volume = volumeSlider.value / 100;
            });
            snoozeSlider.addEventListener('input', () => {
                snoozeValue.textContent = `${snoozeSlider.value} min`;
            });
            
            durationSlider.addEventListener('input', () => {
                durationValue.textContent = `${durationSlider.value} sec`;
            });
            
            timerMinutesInput.addEventListener('change', () => {
                const minutes = parseInt(timerMinutesInput.value) || 60;
                timerDuration = minutes * 60;
                timerRemaining = timerDuration;
                updateTimerDisplay();
            });
        }
        
        // Clock functions
        function updateClock() {
            const now = new Date();
            
            // Update digital clock
            const timeString = now.toLocaleTimeString('en-US', {hour12: false});
            timeDisplay.textContent = timeString;
            
            const dateString = now.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            dateDisplay.textContent = dateString;
            
            // Update analog clock
            const hours = now.getHours() % 12;
            const minutes = now.getMinutes();
            const seconds = now.getSeconds();
            
            const hourDeg = (hours * 30) + (minutes * 0.5);
            const minuteDeg = (minutes * 6) + (seconds * 0.1);
            const secondDeg = seconds * 6;
            
            hourHand.style.transform = `translateX(-50%) rotate(${hourDeg}deg)`;
            minuteHand.style.transform = `translateX(-50%) rotate(${minuteDeg}deg)`;
            secondHand.style.transform = `translateX(-50%) rotate(${secondDeg}deg)`;
            
            // Update next alarm display
            updateNextAlarm();
        }
        
        // Alarm functions
        function createSampleAlarms() {
            alarms = [
                {
                    time: "07:30",
                    label: "Wake Up",
                    tone: "classic",
                    repeat: ["mon", "tue", "wed", "thu", "fri"],
                    active: true
                },
                {
                    time: "08:00",
                    label: "Breakfast",
                    tone: "chime",
                    repeat: ["sat", "sun"],
                    active: true
                },
                {
                    time: "12:00",
                    label: "Lunch Time",
                    tone: "melody",
                    repeat: [],
                    active: true
                }
            ];
            
            renderAlarms();
        }
        
        function addAlarm() {
            const time = alarmTimeInput.value;
            const label = alarmLabelInput.value || "Alarm";
            const tone = alarmToneSelect.value;
            
            // Get repeat days
            const repeatDays = [];
            document.querySelectorAll('.repeat-day:checked').forEach(checkbox => {
                repeatDays.push(checkbox.value);
            });
            
            const newAlarm = {
                time,
                label,
                tone,
                repeat: repeatDays,
                active: true
            };
            
            alarms.push(newAlarm);
            renderAlarms();
            updateNextAlarm();
            
            // Reset form
            alarmLabelInput.value = "";
        }
        
        function renderAlarms() {
            alarmList.innerHTML = '';
            
            alarms.forEach((alarm, index) => {
                const alarmItem = document.createElement('div');
                alarmItem.className = 'alarm-item';
                if (alarmActive && currentAlarm === index) {
                    alarmItem.classList.add('alarm-active');
                }
                
                alarmItem.innerHTML = `
                    <div class="alarm-info">
                        <div class="alarm-time">${alarm.time}</div>
                        <div class="alarm-label">${alarm.label}</div>
                        <div class="alarm-tone">${alarm.tone}</div>
                        <div class="alarm-repeat">${alarm.repeat.join(', ') || 'Once'}</div>
                    </div>
                    <div class="alarm-actions">
                        <label class="toggle-switch">
                            <input type="checkbox" ${alarm.active ? 'checked' : ''} 
                                onchange="toggleAlarm(${index})">
                            <span class="slider"></span>
                        </label>
                        <button class="btn btn-danger" onclick="deleteAlarm(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                alarmList.appendChild(alarmItem);
            });
        }
        
        function toggleAlarm(index) {
            alarms[index].active = !alarms[index].active;
            renderAlarms();
            updateNextAlarm();
        }
        
        function deleteAlarm(index) {
            alarms.splice(index, 1);
            renderAlarms();
            updateNextAlarm();
        }
        
        function snoozeAlarm() {
            if (!alarmActive) return;
            
            dismissAlarm();
            
            const snoozeMinutes = parseInt(snoozeSlider.value);
            const now = new Date();
            const snoozeTime = new Date(now.getTime() + snoozeMinutes * 60000);
            
            const hours = snoozeTime.getHours().toString().padStart(2, '0');
            const minutes = snoozeTime.getMinutes().toString().padStart(2, '0');
            
            const newAlarm = {
                time: `${hours}:${minutes}`,
                label: "Snooze",
                tone: "classic",
                repeat: [],
                active: true
            };
            
            alarms.push(newAlarm);
            renderAlarms();
            updateNextAlarm();
        }
        
        function dismissAlarm() {
            alarmActive = false;
            alarmSound.pause();
            alarmModal.style.display = 'none';
            clearTimeout(alarmTimeout);
            renderAlarms();
        }
        
        function checkAlarms() {
            if (alarmActive) return;
            
            const now = new Date();
            const currentDay = now.toLocaleDateString('en-US', {weekday: 'short'}).toLowerCase();
            const currentHours = now.getHours().toString().padStart(2, '0');
            const currentMinutes = now.getMinutes().toString().padStart(2, '0');
            const currentTime = `${currentHours}:${currentMinutes}`;
            
            for (let i = 0; i < alarms.length; i++) {
                const alarm = alarms[i];
                
                if (!alarm.active) continue;
                
                // Check if alarm repeats today
                if (alarm.repeat.length > 0 && !alarm.repeat.includes(currentDay)) {
                    continue;
                }
                
                // Check if alarm time matches current time
                if (alarm.time === currentTime) {
                    triggerAlarm(i);
                    break;
                }
            }
        }
        
        function triggerAlarm(index) {
            alarmActive = true;
            currentAlarm = index;
            
            // Play alarm sound
            alarmSound.currentTime = 0;
            alarmSound.play();
            
            // Show alarm modal
            alarmMessage.textContent = `${alarms[index].label} - ${alarms[index].time}`;
            alarmModal.style.display = 'flex';
            
            // Update UI
            renderAlarms();
            
            // Set timeout to stop alarm after duration
            const duration = parseInt(durationSlider.value) * 1000;
            alarmTimeout = setTimeout(dismissAlarm, duration);
        }
        
        function updateNextAlarm() {
            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();
            
            let nextAlarm = null;
            let minDiff = Infinity;
            
            for (const alarm of alarms) {
                if (!alarm.active) continue;
                
                const [alarmHours, alarmMinutes] = alarm.time.split(':').map(Number);
                const alarmTime = alarmHours * 60 + alarmMinutes;
                
                // Calculate time difference
                let diff = alarmTime - currentTime;
                if (diff < 0) {
                    diff += 24 * 60; // Add a day
                }
                
                if (diff < minDiff) {
                    minDiff = diff;
                    nextAlarm = alarm;
                }
            }
            
            if (nextAlarm) {
                nextAlarmDisplay.textContent = `${nextAlarm.time} - ${nextAlarm.label}`;
            } else {
                nextAlarmDisplay.textContent = "No alarms set";
            }
        }
        
        // Stopwatch functions
        function toggleStopwatch() {
            if (!stopwatchRunning) {
                // Start the stopwatch
                stopwatchRunning = true;
                stopwatchStartTime = Date.now() - stopwatchElapsed;
                stopwatchInterval = setInterval(updateStopwatch, 10);
                startStopwatchBtn.innerHTML = '<i class="fas fa-pause"></i> Stop';
                lapStopwatchBtn.disabled = false;
            } else {
                // Stop the stopwatch
                stopwatchRunning = false;
                clearInterval(stopwatchInterval);
                stopwatchElapsed = Date.now() - stopwatchStartTime;
                startStopwatchBtn.innerHTML = '<i class="fas fa-play"></i> Start';
                lapStopwatchBtn.disabled = true;
            }
        }
        
        function updateStopwatch() {
            const elapsed = Date.now() - stopwatchStartTime;
            stopwatchElapsed = elapsed;
            
            const milliseconds = Math.floor((elapsed % 1000) / 10);
            const seconds = Math.floor((elapsed / 1000) % 60);
            const minutes = Math.floor((elapsed / (1000 * 60)) % 60);
            const hours = Math.floor(elapsed / (1000 * 60 * 60));
            
            stopwatchDisplay.textContent = 
                `${hours.toString().padStart(2, '0')}:` +
                `${minutes.toString().padStart(2, '0')}:` +
                `${seconds.toString().padStart(2, '0')}.` +
                `${milliseconds.toString().padStart(2, '0')}`;
        }
        
        function recordLap() {
            const elapsed = stopwatchElapsed;
            const lapTime = elapsed - (lapTimes.length > 0 ? lapTimes[lapTimes.length - 1].total : 0);
            
            lapTimes.push({
                number: lapTimes.length + 1,
                time: formatTime(elapsed),
                lapTime: formatTime(lapTime)
            });
            
            renderLaps();
        }
        
        function formatTime(milliseconds) {
            const ms = Math.floor((milliseconds % 1000) / 10);
            const s = Math.floor((milliseconds / 1000) % 60);
            const m = Math.floor((milliseconds / (1000 * 60)) % 60);
            const h = Math.floor(milliseconds / (1000 * 60 * 60));
            
            return `${h.toString().padStart(2, '0')}:` +
                   `${m.toString().padStart(2, '0')}:` +
                   `${s.toString().padStart(2, '0')}.` +
                   `${ms.toString().padStart(2, '0')}`;
        }
        
        function renderLaps() {
            lapList.innerHTML = '';
            
            lapTimes.forEach(lap => {
                const lapItem = document.createElement('div');
                lapItem.className = 'lap-item';
                lapItem.innerHTML = `
                    <div>Lap ${lap.number}</div>
                    <div>${lap.time}</div>
                    <div>${lap.lapTime}</div>
                `;
                lapList.appendChild(lapItem);
            });
        }
        
        function resetStopwatch() {
            stopwatchRunning = false;
            stopwatchElapsed = 0;
            clearInterval(stopwatchInterval);
            stopwatchDisplay.textContent = "00:00:00.00";
            startStopwatchBtn.innerHTML = '<i class="fas fa-play"></i> Start';
            lapStopwatchBtn.disabled = true;
            lapTimes = [];
            renderLaps();
        }
        
        // Timer functions
        function startTimer() {
            if (timerRunning) return;
            
            timerRunning = true;
            startTimerBtn.disabled = true;
            pauseTimerBtn.disabled = false;
            
            timerInterval = setInterval(() => {
                timerRemaining--;
                updateTimerDisplay();
                
                if (timerRemaining <= 0) {
                    timerFinished();
                }
            }, 1000);
        }
        
        function pauseTimer() {
            timerRunning = false;
            clearInterval(timerInterval);
            startTimerBtn.disabled = false;
            pauseTimerBtn.disabled = true;
        }
        
        function resetTimer() {
            timerRunning = false;
            clearInterval(timerInterval);
            timerRemaining = timerDuration;
            updateTimerDisplay();
            startTimerBtn.disabled = false;
            pauseTimerBtn.disabled = true;
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timerRemaining / 60);
            const seconds = timerRemaining % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update progress bar
            const progress = ((timerDuration - timerRemaining) / timerDuration) * 100;
            progressFill.style.width = `${progress}%`;
            
            // Change color based on progress
            if (progress < 50) {
                progressFill.style.backgroundColor = '#1abc9c';
            } else if (progress < 75) {
                progressFill.style.backgroundColor = '#f39c12';
            } else {
                progressFill.style.backgroundColor = '#e74c3c';
            }
        }
        
        function timerFinished() {
            clearInterval(timerInterval);
            timerRunning = false;
            
            // Play alarm sound
            alarmSound.currentTime = 0;
            alarmSound.play();
            
            // Show alert
            alert("Timer completed!");
            
            // Reset after alert
            setTimeout(() => {
                alarmSound.pause();
                resetTimer();
            }, 2000);
        }
        
        // World clock functions
        function createWorldClocks() {
            const timezones = [
                { city: "New York", tz: "America/New_York" },
                { city: "London", tz: "Europe/London" },
                { city: "Tokyo", tz: "Asia/Tokyo" },
                { city: "Sydney", tz: "Australia/Sydney" },
                { city: "Dubai", tz: "Asia/Dubai" },
                { city: "Mumbai", tz: "Asia/Kolkata" }
            ];
            
            timezones.forEach(tz => {
                const clockCard = document.createElement('div');
                clockCard.className = 'clock-card';
                clockCard.innerHTML = `
                    <div class="clock-city">${tz.city}</div>
                    <div class="clock-time" data-tz="${tz.tz}">00:00:00</div>
                    <div class="clock-date" data-tz="${tz.tz}">January 1, 2023</div>
                `;
                worldClocks.appendChild(clockCard);
            });
        }
        
        function updateWorldClocks() {
            const now = new Date();
            
            document.querySelectorAll('.clock-time').forEach(el => {
                const time = now.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    timeZone: el.dataset.tz
                });
                el.textContent = time;
            });
            
            document.querySelectorAll('.clock-date').forEach(el => {
                const date = now.toLocaleDateString('en-US', {
                    weekday: 'short',
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    timeZone: el.dataset.tz
                });
                el.textContent = date;
            });
        }
        
        // Settings functions
        function loadSettings() {
            const savedSettings = localStorage.getItem('alarmClockSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // Apply settings
                volumeSlider.value = settings.volume || 80;
                snoozeSlider.value = settings.snooze || 5;
                durationSlider.value = settings.duration || 30;
                themeSelect.value = settings.theme || 'dark';
                
                // Update UI
                volumeValue.textContent = `${volumeSlider.value}%`;
                snoozeValue.textContent = `${snoozeSlider.value} min`;
                durationValue.textContent = `${durationSlider.value} sec`;
                
                // Set alarm volume
                alarmSound.volume = volumeSlider.value / 100;
                
                // Apply theme
                applyTheme(settings.theme);
            } else {
                // Defaults
                volumeValue.textContent = `${volumeSlider.value}%`;
                snoozeValue.textContent = `${snoozeSlider.value} min`;
                durationValue.textContent = `${durationSlider.value} sec`;
                alarmSound.volume = volumeSlider.value / 100;
            }
        }
        
        function saveSettings() {
            const settings = {
                volume: volumeSlider.value,
                snooze: snoozeSlider.value,
                duration: durationSlider.value,
                theme: themeSelect.value
            };
            
            localStorage.setItem('alarmClockSettings', JSON.stringify(settings));
            
            // Apply theme
            applyTheme(settings.theme);
            
            // Show confirmation
            const notification = document.createElement('div');
            notification.textContent = 'Settings saved successfully!';
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.backgroundColor = '#2ecc71';
            notification.style.color = 'white';
            notification.style.padding = '10px 20px';
            notification.style.borderRadius = '5px';
            notification.style.zIndex = '1000';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }
        
        function applyTheme(theme) {
            if (theme === 'light') {
                document.documentElement.style.setProperty('--primary', '#f5f5f5');
                document.documentElement.style.setProperty('--secondary', '#e0e0e0');
                document.documentElement.style.setProperty('--text', '#333');
                document.documentElement.style.setProperty('--text-light', '#666');
            } else if (theme === 'blue') {
                document.documentElement.style.setProperty('--primary', '#1a2980');
                document.documentElement.style.setProperty('--secondary', '#26d0ce');
                document.documentElement.style.setProperty('--accent', '#00c9ff');
                document.documentElement.style.setProperty('--text', '#fff');
                document.documentElement.style.setProperty('--text-light', '#ccc');
            } else if (theme === 'green') {
                document.documentElement.style.setProperty('--primary', '#0a3d2e');
                document.documentElement.style.setProperty('--secondary', '#1e7a5c');
                document.documentElement.style.setProperty('--accent', '#4caf50');
                document.documentElement.style.setProperty('--text', '#fff');
                document.documentElement.style.setProperty('--text-light', '#ccc');
            } else {
                // Default dark
                document.documentElement.style.setProperty('--primary', '#2c3e50');
                document.documentElement.style.setProperty('--secondary', '#34495e');
                document.documentElement.style.setProperty('--accent', '#1abc9c');
                document.documentElement.style.setProperty('--text', '#ecf0f1');
                document.documentElement.style.setProperty('--text-light', '#bdc3c7');
            }
        }
        
        // Initialize the app when the page loads
        window.addEventListener('load', init);
        window.toggleAlarm = toggleAlarm;
        window.deleteAlarm = deleteAlarm;
    </script>
</body>
</html>